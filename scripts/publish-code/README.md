系统: Centos6.5

代码服务器：10.19.21.249

预发布服务器：10.19.21.241

线上服务器：10.19.21.242 10.19.21.243

 

发布流程：

1. 在代码服务器上导出你要发布的项目

2. 然后选择你将要发布到哪台服务器（预发布｜线上）

3. 使用rsync同步到你选择的服务器

4. 根据你同步的目录创建软链接到网站家目录

####################################################
脚本中用的ansible,需要在主机中安装，并定义hosts文件

脚本中用ansible调用mk_dir.sh脚本在客户端创建以时间命名的目录，并把之前的代码拷贝到新建的时间目录中。方便同步。

###################################################
然后运行脚本，输出结果如下：

请选择你要打包的项目：
	1.  dmin
	2.  baiaimama
	3.  bi
	4.  html5
	5.  integration
	6.  school
	7.  site
	8.  server(全部)
请输入你要打包的编号:4
 
	 正在打包 html5 ...... 
 
	 html5 打包成功 
 
请选择要发布的到哪台服务器:
	1. 预发布
	2. 线上
请输入发布到服务器的编号:2
 
	 正在同步到线上...... 
 
	 同步到线上242成功 
 
	 线上242发布成功 
 
 
	 同步到线上243成功 
 
	 线上243发布成功

最终查看发布结果：
#  ansible online -m shell -a 'ls -l /app/server'
10.19.21.243 | success | rc=0 >>
lrwxrwxrwx 1 root root 35 Aug 26 18:14 /app/server -> /data/deploy/20150826_181341/server
 
10.19.21.242 | success | rc=0 >>
lrwxrwxrwx 1 root root 35 Aug 26 18:14 /app/server -> /data/deploy/20150826_181341/server

